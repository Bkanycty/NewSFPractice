{% extends 'default.html' %}
{% block head %}
{% load static %}
    <link href="{% static 'css/group_css/service_company.css' %}" rel="stylesheet"/>
{% endblock head %}
{% block title %}
Мой Силант {{ user }}
{% endblock title %}
{% block body %}
<main>
    <h1><div class="user">{{ user.first_name }}</div></h1>
    <h2><div class="user">Информация о комплектации и технических характеристиках обслуживаемой техники</p></h2>

<div class="tabs">
    <button class="tabs-button link-row" type="button" onclick="{general_information()}"><h1>Общая инфо</h1></button>
    <button class="tabs-button link-row" type="button" onclick="{maintenances()}"><h1>ТО</h1></button>
    <button class="tabs-button link-row" type="button" onclick="{reclamations()}"><h1>Рекламации</h1></button>
</div>

<table id="general-info-tab" class="search-results">
    <thead class="table-head">
        <th>Модель машины</th><th>Зав. № машины</th><th>Модель двигателя</th><th>Зав. № двигателя</th><th>Модель трансмиссии</th><th>Зав. № трансмиссии</th><th>Модель ведущего моста</th><th>Зав. № ведущего моста</th><th>Модель управляемого моста</th><th>Зав. № управляемого моста</th><th>Договор поставки №, дата</th><th>Дата отгрузки с завода</th><th>Грузополучатель</th><th>Адрес поставки</th><th>Комплектация</th><th>Сервисная компания</th>
    </thead>
    <tbody>
        {% for machine in machines_on_service %}
            <tr class="table-row link-row" onclick='window.location.href="{% url 'machine_detail' machine.id %}";' >
                <td>{{ machine.machine_model }}</td>
                <td>{{ machine.machine_factory_number }}</td>
                <td>{{ machine.engine_model }}</a></td>
                <td>{{ machine.engine_factory_number }}</td>
                <td>{{ machine.transmission_model }}</a></td>
                <td>{{ machine.transmission_factory_number }}</td>
                <td>{{ machine.drive_axle_model }}</a></td>
                <td>{{ machine.drive_axle_factory_number }}</td>
                <td>{{ machine.steering_axle_model }}</a></td>
                <td>{{ machine.steering_axle_factory_number }}</td>
                <td>{{ machine.supply_contract }}</td>
                <td>{{ machine.shipping_date }}</td>
                <td>{{ machine.end_user }}</td>
                <td>{{ machine.delivery_address }}</td>
                <td>{{ machine.complete_set }}</td>
                <td>{{ machine.service_company.first_name }}</td>
            </tr>
        {% endfor %}
    </tr>
    </tbody>
</table>

<table id="maintenance-tab" class="search-results" hidden>
    <button hidden id="maintenance-tab-btn" type="button" class="add-btn" onclick='window.location.href="{% url 'maintenance_create' %}";'><span class="add-btn-span">Внести данные о ТО</span></button>
    <tr class="table-head">
        <th>Обслуживаемая машина</th><th>Вид ТО</th><th>Дата проведения ТО</th><th>Наработка, м/час</th><th>№ заказ-наряда</th><th>Дата заказ-наряда</th><th>Организация, проводившая ТО</th>
    </tr>
    {% for maintenance in maintenances %}
        {% if maintenance.maintenance_machine.service_company == user %}
        <tr class="table-row link-row" onclick='window.location.href="{% url 'maintenance_detail' maintenance.id %}";'>
            <td>{{ maintenance.maintenance_machine }}</td>
            <td>{{ maintenance.maintenance_type }}</td>
            <td>{{ maintenance.maintenance_date }}</td>
            <td>{{ maintenance.running_time }}</a></td>
            <td>{{ maintenance.work_order_number }}</td>
            <td>{{ maintenance.work_order_date }}</a></td>
            <td>{{ maintenance.maintenance_service_company.first_name }}</td>
        {% endif %}
    </tr>
    {% endfor %}
</table>

<table id="reclamations-tab" class="search-results" hidden>
    <button hidden id="reclamations-tab-btn" type="button" class="add-btn" onclick='window.location.href="{% url 'reclamation_create' %}";'><span class="add-btn-span">Зарегистрировать рекламацию</span></button>
    <tr class="table-head">
        <th>Дата отказа</th><th>Наработка, м/час</th><th>Узел отказа</th><th>Описание отказа</th><th>Способ восстановления</th><th>Используемые запасные части</th><th>Дата восстановления</th>
    </tr>
    {% for reclamation in reclamations %}
        {% if reclamation.reclamation_machine.service_company == user %}
        <tr class="table-row link-row" onclick='window.location.href="{% url 'reclamation_detail' reclamation.id %}";'>
            <td>{{ reclamation.breakdown_date }}</td>
            <td>{{ reclamation.running_time }}</td>
            <td>{{ reclamation.broken_node }}</td>
            <td>{{ reclamation.breakdown_description }}</a></td>
            <td>{{ reclamation.recovery_method }}</td>
            <td>{{ reclamation.spare_parts_used }}</a></td>
            <td>{{ reclamation.recovery_date }}</td>
        {% endif %}
    </tr>
    {% endfor %}
</table>

<script type="text/javascript">
    function general_information() {
        var generalTab = document.getElementById("general-info-tab");
        var maintenancesTab = document.getElementById("maintenance-tab");
        var maintenancesBtn = document.getElementById('maintenance-tab-btn');
        var reclamationsTab = document.getElementById("reclamations-tab");
        var reclamationsBtn = document.getElementById('reclamations-tab-btn');

        generalTab.hidden = false;
        maintenancesTab.hidden = true;
        maintenancesBtn.hidden = true;
        reclamationsTab.hidden = true;
        reclamationsBtn.hidden = true;
    };
</script>

<script type="text/javascript">
    function maintenances() {
        var generalTab = document.getElementById("general-info-tab");
        var maintenancesTab = document.getElementById("maintenance-tab");
        var maintenancesBtn = document.getElementById('maintenance-tab-btn');
        var reclamationsTab = document.getElementById("reclamations-tab");
        var reclamationsBtn = document.getElementById('reclamations-tab-btn');

        generalTab.hidden = true;
        maintenancesTab.hidden = false;
        maintenancesBtn.hidden = false;
        reclamationsTab.hidden = true;
        reclamationsBtn.hidden = true;
    };
</script>

<script type="text/javascript">
    function reclamations() {
        var generalTab = document.getElementById("general-info-tab");
        var maintenancesTab = document.getElementById("maintenance-tab");
        var maintenancesBtn = document.getElementById('maintenance-tab-btn');
        var reclamationsTab = document.getElementById("reclamations-tab");
        var reclamationsBtn = document.getElementById('reclamations-tab-btn');

        generalTab.hidden = true;
        maintenancesTab.hidden = true;
        maintenancesBtn.hidden = true;
        reclamationsTab.hidden = false;
        reclamationsBtn.hidden = false;
    };
</script>

</h3>
</main>
{% endblock body %}